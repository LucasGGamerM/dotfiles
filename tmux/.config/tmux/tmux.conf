# Configuração TMUX Dalton Serey / Lucas Gabriel

# Variação para p1 / uso pessoal

# source novos atalhos e comandos
# source ~/.config/tmux/tmux.conf.p1-behavior
# source ~/.config/tmux/tmux.conf.p1-visual

# Options to make tmux more pleasant
set -g mouse on
set -g default-terminal "tmux-256color"
set -g detach-on-destroy off  # don't exit from tmux when closing a session

# disable/enable status bar with 'C-s' (no prefix)
bind-key -n C-s set-option -g status

# Things from tmux-sensible
set-option -g history-limit 50000
set-option -g display-time 4000
set-option -g status-interval 5
set-option -g status-keys emacs
set-option -g focus-events on
set-window-option -g aggressive-resize on

# loud or quiet?
set-option -g visual-activity off
set-option -g visual-bell off
set-option -g visual-silence off
set-window-option -g monitor-activity off
set-option -g bell-action none

# remap prefix from 'C-b' to 'C-a'
unbind-key C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# reload config file
bind-key r source-file ~/.config/tmux/tmux.conf \; display-message "Config successfully reloaded!"

# start with window and pane number 1
set-option -g base-index 1
set-option -g pane-base-index 1

# split vertical panes using | and =
bind-key | split-window -h -c "#{pane_current_path}"
bind-key = split-window -h -c "#{pane_current_path}"
unbind-key %

# split horizontal panes using -
bind-key - split-window -v -c "#{pane_current_path}"
unbind-key '"'

# resize panes with Vim keys (no prefix)
bind-key -n C-S-Left resize-pane -L 1
bind-key -r H resize-pane -L 1

bind-key -n C-S-Right resize-pane -R 1
bind-key -r L resize-pane -R 1

bind-key -n C-S-Down resize-pane -D 1
bind-key -r J resize-pane -D 1

bind-key -n C-S-Up resize-pane -U 1
bind-key -r K resize-pane -U 1

# switch panes using Alt-arrow (no prefix)
bind-key -n M-Left select-pane -L
bind-key h select-pane -L

bind-key -n M-Right select-pane -R
bind-key l select-pane -R

bind-key -n M-Up select-pane -U
bind-key k select-pane -U

bind-key -n M-Down select-pane -D
bind-key j select-pane -D

# vi mode
setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel
bind P paste-buffer

# move panes around
bind-key M choose-tree -Zw "join-pane -h -t '%%'"
bind-key N choose-tree -Zs "join-pane -h -t '%%'"

# move windows around
bind-key B choose-tree -Zw "move-window -d -t '%%'"

# New window on the same path
bind c new-window -c "#{pane_current_path}"

# Continuum
set -g @continuum-restore 'on'
set -g @resurrect-strategy-nvim 'session'

# Change floax bind
set -g @floax-bind 'v'

# panes, dark5 and bg_highlight from tokyonight night
set-option -g pane-border-style 'fg=#737aa2, fg=#292e42'
set-option -g pane-active-border-style 'fg=#737aa2'

# White, dark5 and dark3 from tokyonight night theme // jk no I updated them :D
set-window-option -g window-status-style 'fg=#11111b bg=#9399b2'
set-window-option -g window-status-format ' #I #[fg=#C4CCE9,bg=#313244] #W#{?window_zoomed_flag,+,} '

# White, purple, and magenta from tokyonight night theme # Actually no, now they are from the catppuccin theme
set-window-option -g window-status-current-style 'fg=#11111b bg=#C7A0F6 bold'
set-window-option -g window-status-current-format ' #I #[fg=#cdd6f4 bg=#45475a] #W#{?window_zoomed_flag,+,} '

set-window-option -g window-status-bell-style 'fg=colour255 bg=colour1 bold'

# messages
set-option -g message-style 'fg=colour7 bg=#1a1b26 bold'

# statusbar
set-option -g status-position bottom
wg_is_keys_off="#[fg=colour237,bg=#ffffff]#([ $(tmux show-option -qv key-table) = 'off' ] && echo ' OFF ')#[default]"
set-option -g status-justify left
set -g status-right-length 200
set -g status-left-length 200
set-option -g status-style 'bg=#1a1b26 fg=#ffffff'
set-option -g status-left ' #[fg=#292e42, bg=##9ECE6A, bold] #S '
set -ag status-left "#[bg=#1a1b26] "
set -g status-right ""
set -ag status-right "$wg_is_keys_off"
set -ag status-right "#[bg=#1a1b26] "
# set -ag status-right "#[fg=#292e42,bg=#ffaacc] #W "
# set -ag status-right "#[bg=#1a1b26] "
set -ag status-right "#[fg=#292e42, bg=#aa88cc] #[fg=#292e42]@#[fg=#292e42]#H "
set -ag status-right "#[bg=#1a1b26] "
set -ag status-right "#[bg=#7AA2F7, fg=#292e42] CPU: #{cpu_percentage} "
if-shell '[ -d "/sys/class/power_supply/BAT0" ]' \
  'set -ag status-right "#[bg=#7AA2F7, fg=#292e42]Batt: #{battery_percentage} "' \
# set -ag status-right " #{l:#{battery_percentage}}"

set -ag status-right "#[bg=#1a1b26] "
set -ag status-right "#[bg=#9999ff] %d/%m %Hh%Mm "
set -ag status-right "#[bg=#1a1b26] "

bind -T root F12  \
  run-shell "tmux set-option -g status-position top" \;\
  set prefix None \;\
  set key-table off \;\
  if -F '#{pane_in_mode}' 'send-keys -X cancel' \;\
  refresh-client -S \;\

bind -T off F12 \
  run-shell "tmux set-option -g status-position bottom" \;\
  set -u prefix \;\
  set -u key-table \;\
  set -u status-style \;\
  set -u window-status-current-style \;\
  set -u window-status-current-format \;\
  refresh-client -S \;\

# Plugins
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'LucasGGamerM/tmux-floax'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

#TPM
if "test ! -d ~/.config/tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm && sh ~/.config/tmux/plugins/tpm/bin/install_plugins'"
run '~/.config/tmux/plugins/tpm/tpm'
